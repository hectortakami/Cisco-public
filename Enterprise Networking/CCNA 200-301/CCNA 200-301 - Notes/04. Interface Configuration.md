# **Interface Configuration**

## Interface Speed (full/half duplex)
_Note: By default all interfaces are set as **auto** negotiating the max speed in link.**Both sides in the link must be in the same** (auto-auto or manually changed in both) state so the link can work properly_
```
// Set manually the speed is recommended only on small networks
(config)# interface {gigabit | ethernet} {0-X}/{0-X}
(config-if)# duplex [auto|full|half]
(config-if)# speed [mbps] // Can´t be set on virtual devices (needs to have the physical cable attatched)
```

## Addresing 

### DHCP

_Dynamic Host Configuration Protocol (DHCP): By defining a DHCP server all clients receive an **IP address**, **network mask**, **default gateway** and **DNS server(s)** information. **In IPv6 the multicast address for DHCP Discovery traffic is FF05::1:3**_

_DHCP Operations (in-order of process)_
1. **Discover**: Client sends a **broadcast message to locate DHCP server**
2. **Offer**: The server replies with an **unicast offering a (not in use) address from pool**
3. **Request**: If the address offered it´s **unique (checked by ARP)**, the client accepts it and take it **leased by a defined time**
4. **ACK**: The server is notified that the address has been accepted and **removes it from the pool** so it will not be offered again (at least for the lease time, then can be re-offered to other or the same client)

```
// Displays the number of leased/available addresses and pool data
# show ip dhcp pool

// Displays assigned addresses and it´s MAC addresses
# show ip dhcp binding

// A list of interfaces and addresses leased from the DHCP server
# show ip dhcp binding
```

#### DHCP Server
``` 
(config)# ip dhcp excluded-addresses [start_ip_range_excluded] [end_ip_range_excluded]
(config)# ip dhcp pool [dhcp_pool_name]
(config-dhcp)# network [dhcp_network_to_assign_addresses] [netmask]
(config-dhcp)# default-router [default_gateway_to_propagate]
(config-dhcp)# dns-server [dns_server_to_propagate]
```

_The **DHCP Discovery message (broadcast) is NOT forwarded for a router** if we have the DHCP server in other network. To enable DHCP communications and addressing response from one network to another we need to do the following configuration on any router in the middle of the client and server. If a **client is not reaching the DHCP server** it´ll have an **169.254.0.0** address._
```
// Configuration on routing´s interface that connect DHCP server network
(config)# interface {gigabit | ethernet} {0-X}/{0-X}
(config-if)# ip helper-address [dhcp_server_ip_address]
```

#### DHCP Client
```
// Configuration interface to dynamic addressing
(config)# interface {gigabit | ethernet} {0-X}/{0-X}
(config-if)# ip address dhcp
```

### Manually Assigned

#### IP4
```
(config)# interface {gigabit | ethernet} {0-X}/{0-X}
(config-if)# ip address [ipv4] [netmask]
(config-if)# description [interface_description]
(config-if)# no shutdown
```

#### IP6 
_Designed to support built-in security, host mobility and **solve problems in unicast communication that NAT couldn´t** (direct IP phone calls, firewalls, traversal and proxy servers 1-t0-1 reachability). **128 bit address (16x8 bits)**. A **dual stack** implementation supports both IPv4 and IPv6. IPv6 doesn´t support broadcast traffic but it supports **multicast via FF02::1**_
```
# show ipv6 int brief

// Display link-local and global unicast address from neighbors
# show ipv6 neighbors
```
- **Global Unicast (2000::/3)**
  
  _Similar to **public addresses** in IPv4, are used to internet reachability **well-defined hosts with static identification** (like servers), commonly used for organizations with **2001:DB8:0::/48**_

- **Unique Local (FC00::/7)**
  
  _Similar to **private addresses** in IPv4 (from RFC 1918). Used only for internal LAN reachability._

- **Link-local (FE80::/10 - FEB0::/10)**
  _Defined link for communications that group hosts to allow **data-flow between it´s member hosts only** and it´s locally significant to allow **inter-host reachability in the LAN**._

- **EUI-64**

  _**Autogenerated IPv6 address** defining the network portion (64 bits) to use and by **MAC partitioning will be derived the host unique** assignation. The 48 bits in host **MAC is prefixed with FF:FE** and the **7th bit is modified** in order to get the 64 bits in host portion remaining. All **Link-local addresses are autogenerated with EUI-64 by default in Cisco devices**._

```
// Enable IPv6 usage
(config)# ipv6 unicast-routing
```
```
(config)# interface {gigabit | ethernet} {0-X}/{0-X}
(config-if)# description [interface_description]
(config-if)# no shutdown

// Global Unique addressing
(config-if)# ipv6 address [ipv6_global_unique]/[cidr]? 
// EUI-64 autogenerated addressing
(config-if)# ipv6 address [ipv6_64_network_prefix]/64? eui-64 

// Override the EUI-64 default link-local
(config-if)# ipv6 address [link_local_address] link-local
```

**Stateless Address AutoConfiguration (SLAAC)**

  _By using SLAAC the **router advertise their interface IPv6 subnet (Global Unicast address)** to all hosts by ICMP and use it to assign them addressing. A **DHCPv6 is still required** because **SLAAC ONLY advertise the subnet**, **assign addresses** and **it´s default gateway** but **CAN´T setup a DNS server for hosts**. When a host is using SLAAC it will send all traffic through **:: (unespecify address)**. SLAAC doen´t use ARP, it uses simmilar packets known as **Neighbor Discovery (Solicitations & Advetisements) through ICMP**._

  _DHCPv6 represent a significant network security because it keeps track of IPv6-MAC addresses leased and because IPv6 is based on unicasting traffic an attacker can connect directly to a host. That´s why **the only reason to have DHCPv6 enable is for DNS acknowlegment** and we must **disable any possible IPv6 assignation from DHCP** converting all DHCP requests into **Stateless** to only conserve SLAAC IPv6_
  ```
  (config)# interface {gigabit | ethernet} {0-X}/{0-X}
  (config-if)# ipv6 nd other-config-flag
  ```
